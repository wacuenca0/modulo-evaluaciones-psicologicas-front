<div class="clinic-container my-8">
  <div class="bg-white rounded-lg shadow p-6 max-w-md mx-auto">
    <app-users-tabs></app-users-tabs>
    <h3 class="text-lg font-semibold mb-4">Cambiar contraseña de {{ username }}</h3>
    <form (ngSubmit)="submit()" [formGroup]="form" class="space-y-4">
      <div>
        <label for="password" class="form-label">Nueva contraseña</label>
        <input id="password" type="password" formControlName="password" class="form-input w-full" autocomplete="new-password" />
      </div>
      @if (error()) {
        <div class="text-sm text-red-600" role="alert">{{ error() }}</div>
      }
      <div class="flex justify-end">
        <button class="btn-primary" type="submit" [disabled]="loading() || form.invalid">{{ loading() ? 'Guardando…' : 'Cambiar' }}</button>
      </div>
    </form>
  </div>

  <!-- Modal de confirmación de solicitud enviada -->
  @if (!loading() && error() === null) {
    <div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40">
      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm text-center">
        <svg class="mx-auto mb-3 h-10 w-10 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <h4 class="text-lg font-semibold mb-2">Solicitud enviada</h4>
        <p class="text-sm text-slate-700 mb-4">Espere a que el administrador revise su solicitud y le notifique el cambio.</p>
        <button class="btn-primary" type="button" (click)="irAUsuarios()">Aceptar</button>
      </div>
    </div>
  }

  <!-- Modal de error al enviar solicitud -->
  @if (!loading() && error()) {
    <div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40">
      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm text-center">
        <svg class="mx-auto mb-3 h-10 w-10 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
        <h4 class="text-lg font-semibold mb-2">No se pudo enviar la solicitud</h4>
        <p class="text-sm text-slate-700 mb-4">Inténtelo más tarde o contacte al administrador.</p>
        <button class="btn-primary" type="button" (click)="error.set(null)">Cerrar</button>
      </div>
    </div>
  }
</div>
